model Templates {
  id      String                 @id @unique
  link            String                 @unique
  slugUrl         String                 @unique
  categories      TemplateCategory
  createdAt       DateTime               @default(now())
  updatedAt       DateTime               @updatedAt
  title           String
  familyId        String
  isLatest        Boolean                @default(true)
  version         Int                    @default(1)
  sourceServerId  String?
  description     String?
  authorId        String?
  addingUserId    String?
  code            String?
  usageCount      Int                    @default(0)
  channelsCount   Int                    @default(0)
  rolesCount      Int                    @default(0)
  categoriesCount Int                    @default(0)
  visitHistory    VisitTemplateHistory[]
  editings        Builder[]
  author          User?                  @relation("AuthorTemplates", fields: [authorId], references: [userId])
  addingUser      User?                  @relation("AddedTemplates", fields: [addingUserId], references: [userId])

  @@index([usageCount])
  @@index([createdAt])
  @@index([authorId])
  @@index([addingUserId])
  @@index([sourceServerId])
  @@index([familyId])
}

model VisitTemplateHistory {
  id        Int       @id @default(autoincrement())
  uuid      String
  slugUrl   String
  visitedAt DateTime  @default(now())
  url       Templates @relation(fields: [slugUrl], references: [slugUrl], onDelete: Cascade, onUpdate: Cascade)

  @@index([slugUrl])
}

model ReserveTemplate {
  id       Int     @id @default(autoincrement())
  name     String?
  serverId String?
}
